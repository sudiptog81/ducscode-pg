install.packages(c("ggplot2", "psych"))
library(ggplot2)
setwd("~/ducscode-pg/SemI/MC/project")
library(readxl)
data <- read_excel("NFHS_5_Factsheets_Data.xlsx")
total_data <- data[data$Area == 'Total',]
total_data <- data[data$`States/UTs` != 'India',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
data <- read_excel("NFHS_5_Factsheets_Data.xlsx")
total_data <- data[data$Area == 'Total',]
total_data <- data[data$Area == 'Total',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
sd(delivery_care_data$`Home births that were conducted by skilled health personnel  (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Institutional births (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Institutional births in public facility (in the 5 years before the survey) (%)`)
```{r echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
sd(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a public health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
library(ggplot2)
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
library(readxl)
data <- read_excel("NFHS_5_Factsheets_Data.xlsx")
total_data <- data[data$Area == 'Total',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
sd(delivery_care_data$`Institutional births (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Institutional births in public facility (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Home births that were conducted by skilled health personnel  (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a public health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
library(ggplot2)
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
library(readxl)
data <- read_excel("NFHS_5_Factsheets_Data.xlsx")
total_data <- data[data$Area == 'Total',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
sd(delivery_care_data$`Institutional births (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Institutional births in public facility (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Home births that were conducted by skilled health personnel  (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a public health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
library(ggplot2)
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
ggplot(delivery_care_data, aes(x=.data[[names(delivery_care_data)[5]]])) + ggtitle(names(delivery_care_data)[5]) +
geom_histogram(aes(y = ..density..), colour = 1, fill = "cyan") +
geom_density(lwd = 1.2,
linetype = 2,
colour = 1)
library(readxl)
data <- read_excel("NFHS_5_Factsheets_Data.xlsx")
total_data <- data[data$Area == 'Total',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
sd(delivery_care_data$`Institutional births (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Institutional births in public facility (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Home births that were conducted by skilled health personnel  (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a public health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
library(ggplot2)
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
ggplot(delivery_care_data, aes(x=.data[[names(delivery_care_data)[5]]])) + ggtitle(names(delivery_care_data)[5]) +
geom_histogram(aes(y = ..density..), colour = 1, fill = "cyan") +
geom_density(lwd = 1.2,
linetype = 2,
colour = 1)
ggplot(delivery_care_data, aes(x=.data[[names(delivery_care_data)[2]]])) + ggtitle(names(delivery_care_data)[2]) +
geom_histogram(aes(y = ..density..), colour = 1, fill = "cyan") +
geom_density(lwd = 1.2,
linetype = 2,
colour = 1)
library(readxl)
data <- read_excel("NFHS_5_Factsheets_Data.xlsx")
total_data <- data[data$Area == 'Total',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
sd(delivery_care_data$`Institutional births (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Institutional births in public facility (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Home births that were conducted by skilled health personnel  (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`)
sd(delivery_care_data$`Births delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
sd(delivery_care_data$`Births in a public health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)
library(ggplot2)
ggplot(stack(delivery_care_data[, 2:8]), aes(x=ind, y=values)) +
geom_boxplot() +
stat_boxplot(geom = 'errorbar') +
theme(legend.position = "none") +
xlab('') +
ylab('')
ggplot(delivery_care_data, aes(x=.data[[names(delivery_care_data)[5]]])) + ggtitle(names(delivery_care_data)[5]) +
geom_histogram(aes(y = ..density..), colour = 1, fill = "cyan") +
geom_density(lwd = 1.2,
linetype = 2,
colour = 1)
ggplot(delivery_care_data, aes(x=.data[[names(delivery_care_data)[2]]])) + ggtitle(names(delivery_care_data)[2]) +
geom_histogram(aes(y = ..density..), colour = 1, fill = "cyan") +
geom_density(lwd = 1.2,
linetype = 2,
colour = 1)
library(ggplot2)
Pie1 <- read_excel("./Pie1.xlsx")
percent <- Pie1[,2]
sectors <- Pie1[,1]
ggplot(Pie1, aes(x = "", y = Value, fill = Label)) + coord_polar("y", start = 0) + ggtitle(" Distribution of births among Institutional and Non-Institutional Centers ")+ theme(plot.title = element_text(hjust = 0.5, size =20))+ theme_void()+ scale_fill_viridis_d() + geom_bar( stat = "identity", color = "black") + geom_text(aes(label = Value), color = c("black","white","white","white"),position = position_stack(vjust = 0.5),size =3)
colors = c("brown", "orange")
Sector <- c("Private Sector", "Public Sector")
regions <- c("Caesarean Delivery", "Normal Delivery")
# Create the matrix of the values.
Values <- matrix(c(47.4, 14.3, 52.6, 85.7), nrow = 2, ncol = 2, byrow = TRUE)
# Create the bar chart
barplot(Values, main = "Births in Health Institutions", names.arg = Sector, xlab = "Sector", ylab = "Percentage", col = colors, beside = TRUE)
legend("topleft", regions, cex = 0.9, fill = colors)
colors = c("brown", "orange")
Sector <- c("Private Sector", "Public Sector")
regions <- c("Caesarean Delivery", "Normal Delivery")
# Create the matrix of the values.
Values <- matrix(c(47.4, 14.3, 52.6, 85.7), nrow = 2, ncol = 2, byrow = TRUE)
# Create the bar chart
barplot(Values, main = "Births in Health Institutions", names.arg = Sector, xlab = "Sector", ylab = "Percentage", col = colors, beside = TRUE)
legend("topleft", regions, cex = 0.9, fill = colors)
total_data <- data[data$Area == 'Total',]
total_data <- subset(total_data, select=-c(Area))
library(dplyr)
library(tidyr)
total_data %>%
mutate_if(is.numeric, ~replace_na(.,mean(., na.rm = TRUE)))
delivery_care_data <- subset(total_data, select=c(1, 54:60))
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], as.numeric)
delivery_care_data[c(2:8)] <- sapply(delivery_care_data[c(2:8)], abs)
india_delivery_care_data = delivery_care_data[delivery_care_data$`States/UTs` == 'India',]
delivery_care_data <- delivery_care_data[delivery_care_data$`States/UTs` != 'India',]
delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`[is.na(delivery_care_data$`Births in a private health facility that were delivered by caesarean section (in the 5 years before the survey) (%)`)] <- 0
summary(delivery_care_data)
library(ggplot2)
library(maptools)
library(maptools)
library(rgeos)
shp <- readShapeSpatial('India_State_Boundary.shp')
shp <- readShapeSpatial('India_State_Boundary.shp')
plot(shp)
shp$Name
shp.f <- fortify(shp, region="Name")
shp.f <- fortify(shp, region="Name")
delivery_care_data$id = delivery_care_data$`States/UTs`
delivery_care_data$id[delivery_care_data$id == 'Tamil Nadu'] <- 'Tamilnadu'
delivery_care_data$id[delivery_care_data$id == 'Maharastra'] <- 'Maharashtra'
delivery_care_data$id[delivery_care_data$id == 'Chhattisgarh'] <- 'Chhattishgarh'
delivery_care_data$id[delivery_care_data$id == 'Telangana'] <- 'Telengana'
delivery_care_data$id[delivery_care_data$id == 'Andaman & Nicobar Islands'] <- 'Andaman & Nicobar'
merge.shp.coef <- merge(shp.f, delivery_care_data, by="id")
merge.shp.coef <- merge(shp.f, delivery_care_data, by="id")
d <- merge.shp.coef[order(merge.shp.coef$order), ]
library(pracma)
library(stringr)
ggplot() +
geom_polygon(data = shp.f,
aes(x = long, y = lat, group = group),
color = "black", size = 0.25) +
geom_polygon(data = d,
aes(x = long, y = lat, group = group, fill = d[[names(delivery_care_data)[5]]]),
color = "black", size = 0.25) +
coord_map()+
scale_fill_viridis_c(name='', option = "magma") +
labs(title="Births Attended by Trained Medical Personnel")
d %>% arrange(desc(`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`))
ggplot(data=d, aes(x=.data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`, y=reorder(id, `Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`), fill=id)) +
geom_bar(stat="identity", width=0.5) + xlab('') + ylab('') + theme(legend.position = "none") +
geom_text(aes(label=str_glue('{.data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`}%')),
hjust = 1, nudge_x = -1,
color = "black",
size = 2)
View(d)
delivery_care_data %>% arrange(desc('Births attended by skilled health personnel (in the 5 years before the survey)10 (%)'))
ggplot(data=delivery_care_data, aes(x=.data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`, y=reorder(id, `Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`), fill=id)) +
geom_bar(stat="identity", width=0.5) + xlab('') + ylab('') + theme(legend.position = "none") +
geom_text(aes(label=str_glue('{.data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`}%')),
hjust = 1, nudge_x = -1,
color = "black",
size = 2)
delivery_care_data %>% arrange(desc('Births attended by skilled health personnel (in the 5 years before the survey)10 (%)'))
ggplot(data=delivery_care_data, aes(x=.data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`, y=reorder(id, `Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`), fill=id)) +
geom_bar(stat="identity", width=0.5) + xlab('') + ylab('') + theme(legend.position = "none") +
geom_text(aes(label=str_glue('{.data$`Births attended by skilled health personnel (in the 5 years before the survey)10 (%)`}%')),
hjust = 1, nudge_x = -1,
color = "black",
size = 2)
